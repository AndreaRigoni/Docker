# To USE this file:

## This was a minimalist fedora called 'myfedora:v1' created using:
#yum --installroot=/root/fedroot --releasever=20 install yum fedora-release-20 coreutils
#cd /root/fedroot/
#rm -rf ./var/cache/yum/* ./var/lib/yum/yumdb/* ./var/lib/yum/history/* ./var/log/yum.log
#tar -czf - . | docker import - myfedora:v1

## Build the Mdsplus distribution onto myfedora:v1 using this file
# docker build -t "myfedora:MdsPlus" .

# try image out running sh (no bash as yet !)
##docker run -t -i myfedora:MdsPlus /bin/sh
# Run with a shared directory in the /dshare mounted in /opt/dshare
##docker run -i -t -v /dshare:/opt/dshare -t myfedora:MdsPlus /bin/bash

FROM fedora

MAINTAINER Tom Fredian, version: 0.1

# Install rpmfusion updates
#RUN cat /etc/yum.repos.d/fedora.repo
#RUN yum -y install yum-plugin-fastestmirror
#RUN yum -y makecachefast
#RUN yum -y install --nogpgcheck http://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-stable.noarch.rpm http://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-stable.noarch.rpm
#RUN yum -y update rpmfusion\*
#RUN yum -y update
#RUN yum -y install vim-minimal procps-ng nmap openssh-clients rsync bash

#RUN yum -y update
RUN yum -y install autoconf automake mingw* make
RUN rm -rf ./var/cache/yum/* ./var/lib/yum/yumdb/* ./var/lib/yum/history/* ./var/log/yum.log
RUN cd /root
RUN cvs -d :pserver:MDSguest:MDSguest@www.mdsplus.org:/mdsplus/repos login
RUN cvs -d :pserver:MDSguest@www.mdsplus.rog:/mdsplus/repos co mdsplus
RUN cd mdsplus; ./configure --host=i686-w64-mingw32 --build=i686-redhat-linux-gnu --target=i686-w64-mingw32 --prefix=/root/mingw-build --exec-prefix=/root/mingw-build --libdir=/root/mingw-build/bin_x86 --bindir=/root/mingw-build/bin_x86 --enable-mdsip_connections --with-labview=/mnt/scratch/mdsplus/natinst/Labview-2014-windows-x86 --with-jdk=/etc/alternatives/java_sdk --with-idl=/usr/local/idl --with-java_target=6 --with-java_bootclasspath=$(pwd)/rt.jar --with-optimization=g
RUN make; make install
RUN ./configure --host=x64-w64-mingw32 --build=x64-redhat-linux-gnu --target=x64-w64-mingw32 --prefix=/root/mingw-build --exec-prefix=/root/mingw-build --libdir=/root/mingw-build/bin_x86_64 --bindir=/root/mingw-build/bin_x86_64 --enable-mdsip_connections --with-labview=/mnt/scratch/mdsplus/natinst/Labview-2014-windows-x86 --with-jdk=/etc/alternatives/java_sdk --with-idl=/usr/local/idl --with-java_target=6 --with-java_bootclasspath=$(pwd)/rt.jar --with-optimization=g
RUN make; make install
#
#
#FROM fedora:20
#
#MAINTAINER Tom Fredian, version: 0.1
#
#RUN yum -y install yum-plugin-fastestmirror
#RUN yum -y install --nogpgcheck http://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-stable.noarch.rpm http://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-stable.noarch.rpm
#RUN yum -y update rpmfusion\*
#RUN yum -y update
#RUN yum -y install vim-minimal procps-ng nmap openssh-clients rsync bash
#RUN yum -y update
#RUN yum -y install autoconf automake mingw* make
#RUN cd /root
#RUN cvs -d :pserver:MDSguest:MDSguest@www.mdsplus.org:/mdsplus/repos login
#RUN cvs -d :pserver:MDSguest@www.mdsplus.rog:/mdsplus/repos co mdsplus
#RUN cd mdsplus; ./configure --host=i686-w64-mingw32 --build=i686-redhat-linux-gnu --target=i686-w64-mingw32 --prefix=/root/mingw-build --exec-prefix=/root/mingw-build --libdir=/root/mingw-build/bin_x86 --bindir=/root/mingw-build/bin_x86 --enable-mdsip_connections --with-labview=/mnt/scratch/mdsplus/natinst/Labview-2014-windows-x86 --with-jdk=/etc/alternatives/java_sdk --with-idl=/usr/local/idl --with-java_target=6 --with-java_bootclasspath=$(pwd)/rt.jar --with-optimization=g
#RUN make; make install
#RUN ./configure --host=x64-w64-mingw32 --build=x64-redhat-linux-gnu --target=x64-w64-mingw32 --prefix=/root/mingw-build --exec-prefix=/root/mingw-build --libdir=/root/mingw-build/bin_x86_64 --bindir=/root/mingw-build/bin_x86_64 --enable-mdsip_connections --with-labview=/mnt/scratch/mdsplus/natinst/Labview-2014-windows-x86 --with-jdk=/etc/alternatives/java_sdk --with-idl=/usr/local/idl --with-java_target=6 --with-java_bootclasspath=$(pwd)/rt.jar --with-optimization=g
#RUN make; make install
